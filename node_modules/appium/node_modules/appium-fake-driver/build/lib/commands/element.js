'use strict';

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _Object$assign = require('babel-runtime/core-js/object/assign')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _appiumBaseDriver = require('appium-base-driver');

var commands = {},
    helpers = {},
    extensions = {};

helpers.getElements = function (elIds) {
  var _this = this;

  var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    for (var _iterator = _getIterator(elIds), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      var elId = _step.value;

      if (!_lodash2['default'].has(this.elMap, elId)) {
        throw new _appiumBaseDriver.errors.StaleElementReferenceError();
      }
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator['return']) {
        _iterator['return']();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }

  return elIds.map(function (e) {
    return _this.elMap[e];
  });
};

helpers.getElement = function (elId) {
  return this.getElements([elId])[0];
};

commands.getName = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.tagName);

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.elementDisplayed = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.isVisible());

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.elementEnabled = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.isEnabled());

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.elementSelected = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.isSelected());

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.setValue = function callee$0$0(keys, elementId) {
  var value, el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        value = keys;

        if (keys instanceof Array) {
          value = keys.join("");
        }
        el = this.getElement(elementId);

        if (!(el.type !== "MockInputField")) {
          context$1$0.next = 5;
          break;
        }

        throw new _appiumBaseDriver.errors.InvalidElementStateError();

      case 5:
        el.setAttr('value', value);

      case 6:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getText = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.getAttr('value'));

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.clear = function callee$0$0(elementId) {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        context$1$0.next = 2;
        return _regeneratorRuntime.awrap(this.setValue('', elementId));

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.click = function callee$0$0(elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        this.assertNoAlert();
        el = this.getElement(elementId);

        if (el.isVisible()) {
          context$1$0.next = 4;
          break;
        }

        throw new _appiumBaseDriver.errors.InvalidElementStateError();

      case 4:
        el.click();
        this.focusedElId = elementId;

      case 6:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getAttribute = function callee$0$0(attr, elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.getAttr(attr));

      case 2:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getLocation = function (elementId) {
  var el = this.getElement(elementId);
  return el.getLocation();
};

commands.getSize = function (elementId) {
  var el = this.getElement(elementId);
  return el.getSize();
};

commands.equalsElement = function (el1Id, el2Id) {
  var el1 = this.getElement(el1Id);
  var el2 = this.getElement(el2Id);
  return el1.equals(el2);
};

commands.getLocationInView = commands.getLocation;

commands.getCssProperty = function callee$0$0(prop, elementId) {
  var el;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        this.assertWebviewContext();
        el = this.getElement(elementId);
        return context$1$0.abrupt('return', el.getCss(prop));

      case 3:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

_Object$assign(extensions, commands, helpers);
exports.commands = commands;
exports.helpers = helpers;
exports['default'] = extensions;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O3NCQUFjLFFBQVE7Ozs7Z0NBQ0Msb0JBQW9COztBQUUzQyxJQUFJLFFBQVEsR0FBRyxFQUFFO0lBQUUsT0FBTyxHQUFHLEVBQUU7SUFBRSxVQUFVLEdBQUcsRUFBRSxDQUFDOztBQUVqRCxPQUFPLENBQUMsV0FBVyxHQUFHLFVBQVUsS0FBSyxFQUFFOzs7Ozs7OztBQUNyQyxzQ0FBaUIsS0FBSyw0R0FBRTtVQUFmLElBQUk7O0FBQ1gsVUFBSSxDQUFDLG9CQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFO0FBQzVCLGNBQU0sSUFBSSx5QkFBTywwQkFBMEIsRUFBRSxDQUFDO09BQy9DO0tBQ0Y7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDRCxTQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDO1dBQUssTUFBSyxLQUFLLENBQUMsQ0FBQyxDQUFDO0dBQUEsQ0FBQyxDQUFDO0NBQ3hDLENBQUM7O0FBRUYsT0FBTyxDQUFDLFVBQVUsR0FBRyxVQUFVLElBQUksRUFBRTtBQUNuQyxTQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQ3BDLENBQUM7O0FBRUYsUUFBUSxDQUFDLE9BQU8sR0FBRyxvQkFBZ0IsU0FBUztNQUN0QyxFQUFFOzs7O0FBQUYsVUFBRSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDOzRDQUM1QixFQUFFLENBQUMsT0FBTzs7Ozs7OztDQUNsQixDQUFDOztBQUVGLFFBQVEsQ0FBQyxnQkFBZ0IsR0FBRyxvQkFBZ0IsU0FBUztNQUMvQyxFQUFFOzs7O0FBQUYsVUFBRSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDOzRDQUM1QixFQUFFLENBQUMsU0FBUyxFQUFFOzs7Ozs7O0NBQ3RCLENBQUM7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TyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0NBQ3hCLENBQUM7O0FBRUYsUUFBUSxDQUFDLGlCQUFpQixHQUFHLFFBQVEsQ0FBQyxXQUFXLENBQUM7O0FBRWxELFFBQVEsQ0FBQyxjQUFjLEdBQUcsb0JBQWdCLElBQUksRUFBRSxTQUFTO01BRW5ELEVBQUU7Ozs7QUFETixZQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztBQUN4QixVQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7NENBQzVCLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDOzs7Ozs7O0NBQ3ZCLENBQUM7O0FBRUYsZUFBYyxVQUFVLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLFFBQVEsR0FBUixRQUFRO1FBQUUsT0FBTyxHQUFQLE9BQU87cUJBQ1gsVUFBVSIsImZpbGUiOiJsaWIvY29tbWFuZHMvZWxlbWVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBlcnJvcnMgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuXG5sZXQgY29tbWFuZHMgPSB7fSwgaGVscGVycyA9IHt9LCBleHRlbnNpb25zID0ge307XG5cbmhlbHBlcnMuZ2V0RWxlbWVudHMgPSBmdW5jdGlvbiAoZWxJZHMpIHtcbiAgZm9yIChsZXQgZWxJZCBvZiBlbElkcykge1xuICAgIGlmICghXy5oYXModGhpcy5lbE1hcCwgZWxJZCkpIHtcbiAgICAgIHRocm93IG5ldyBlcnJvcnMuU3RhbGVFbGVtZW50UmVmZXJlbmNlRXJyb3IoKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGVsSWRzLm1hcCgoZSkgPT4gdGhpcy5lbE1hcFtlXSk7XG59O1xuXG5oZWxwZXJzLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoZWxJZCkge1xuICByZXR1cm4gdGhpcy5nZXRFbGVtZW50cyhbZWxJZF0pWzBdO1xufTtcblxuY29tbWFuZHMuZ2V0TmFtZSA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC50YWdOYW1lO1xufTtcblxuY29tbWFuZHMuZWxlbWVudERpc3BsYXllZCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5pc1Zpc2libGUoKTtcbn07XG5cbmNvbW1hbmRzLmVsZW1lbnRFbmFibGVkID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmlzRW5hYmxlZCgpO1xufTtcblxuY29tbWFuZHMuZWxlbWVudFNlbGVjdGVkID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmlzU2VsZWN0ZWQoKTtcbn07XG5cbmNvbW1hbmRzLnNldFZhbHVlID0gYXN5bmMgZnVuY3Rpb24gKGtleXMsIGVsZW1lbnRJZCkge1xuICBsZXQgdmFsdWUgPSBrZXlzO1xuICBpZiAoa2V5cyBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgdmFsdWUgPSBrZXlzLmpvaW4oXCJcIik7XG4gIH1cbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIGlmIChlbC50eXBlICE9PSBcIk1vY2tJbnB1dEZpZWxkXCIpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRFbGVtZW50U3RhdGVFcnJvcigpO1xuICB9XG4gIGVsLnNldEF0dHIoJ3ZhbHVlJywgdmFsdWUpO1xufTtcblxuY29tbWFuZHMuZ2V0VGV4dCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5nZXRBdHRyKCd2YWx1ZScpO1xufTtcblxuY29tbWFuZHMuY2xlYXIgPSBhc3luYyBmdW5jdGlvbiAoZWxlbWVudElkKSB7XG4gIGF3YWl0IHRoaXMuc2V0VmFsdWUoJycsIGVsZW1lbnRJZCk7XG59O1xuXG5jb21tYW5kcy5jbGljayA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgdGhpcy5hc3NlcnROb0FsZXJ0KCk7XG4gIGxldCBlbCA9IHRoaXMuZ2V0RWxlbWVudChlbGVtZW50SWQpO1xuICBpZiAoIWVsLmlzVmlzaWJsZSgpKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5JbnZhbGlkRWxlbWVudFN0YXRlRXJyb3IoKTtcbiAgfVxuICBlbC5jbGljaygpO1xuICB0aGlzLmZvY3VzZWRFbElkID0gZWxlbWVudElkO1xufTtcblxuY29tbWFuZHMuZ2V0QXR0cmlidXRlID0gYXN5bmMgZnVuY3Rpb24gKGF0dHIsIGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmdldEF0dHIoYXR0cik7XG59O1xuXG5jb21tYW5kcy5nZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5nZXRMb2NhdGlvbigpO1xufTtcblxuY29tbWFuZHMuZ2V0U2l6ZSA9IGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5nZXRTaXplKCk7XG59O1xuXG5jb21tYW5kcy5lcXVhbHNFbGVtZW50ID0gZnVuY3Rpb24gKGVsMUlkLCBlbDJJZCkge1xuICBsZXQgZWwxID0gdGhpcy5nZXRFbGVtZW50KGVsMUlkKTtcbiAgbGV0IGVsMiA9IHRoaXMuZ2V0RWxlbWVudChlbDJJZCk7XG4gIHJldHVybiBlbDEuZXF1YWxzKGVsMik7XG59O1xuXG5jb21tYW5kcy5nZXRMb2NhdGlvbkluVmlldyA9IGNvbW1hbmRzLmdldExvY2F0aW9uO1xuXG5jb21tYW5kcy5nZXRDc3NQcm9wZXJ0eSA9IGFzeW5jIGZ1bmN0aW9uIChwcm9wLCBlbGVtZW50SWQpIHtcbiAgdGhpcy5hc3NlcnRXZWJ2aWV3Q29udGV4dCgpO1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmdldENzcyhwcm9wKTtcbn07XG5cbk9iamVjdC5hc3NpZ24oZXh0ZW5zaW9ucywgY29tbWFuZHMsIGhlbHBlcnMpO1xuZXhwb3J0IHsgY29tbWFuZHMsIGhlbHBlcnMgfTtcbmV4cG9ydCBkZWZhdWx0IGV4dGVuc2lvbnM7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
