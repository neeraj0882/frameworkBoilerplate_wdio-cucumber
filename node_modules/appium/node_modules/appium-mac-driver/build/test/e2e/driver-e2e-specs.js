'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _wd = require('wd');

var _wd2 = _interopRequireDefault(_wd);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _libServer = require('../../lib/server');

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var TEST_PORT = 4788;
var TEST_HOST = "localhost";

var server = undefined,
    driver = undefined;

describe('Driver', function () {
  before(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _libServer.startServer)(TEST_PORT, TEST_HOST));

        case 2:
          server = context$2$0.sent;

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(server.close());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          driver = _wd2['default'].promiseChainRemote(TEST_HOST, TEST_PORT);

        case 1:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  afterEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.quit());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  it('should run a basic session using a real client', function callee$1$0() {
    var button;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.init({
            app: "Calculator",
            platformName: "Mac",
            deviceName: "Mac"
          }));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.elementByXPath("/AXApplication[@AXTitle='Calculator']/AXWindow[0]/AXGroup[1]/AXButton[@AXDescription='nine']"));

        case 4:
          button = context$2$0.sent;
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(button.click());

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL2RyaXZlci1lMmUtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O2tCQUFlLElBQUk7Ozs7b0JBQ0YsTUFBTTs7Ozs4QkFDSSxrQkFBa0I7Ozs7eUJBQ2pCLGtCQUFrQjs7QUFDOUMsa0JBQUssTUFBTSxFQUFFLENBQUM7QUFDZCxrQkFBSyxHQUFHLDZCQUFnQixDQUFDOztBQUV6QixJQUFNLFNBQVMsR0FBRyxJQUFJLENBQUM7QUFDdkIsSUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDOztBQUU5QixJQUFJLE1BQU0sWUFBQTtJQUFFLE1BQU0sWUFBQSxDQUFDOztBQUVuQixRQUFRLENBQUMsUUFBUSxFQUFFLFlBQVk7QUFDN0IsUUFBTSxDQUFDOzs7OzsyQ0FDVSw0QkFBWSxTQUFTLEVBQUUsU0FBUyxDQUFDOzs7QUFBaEQsZ0JBQU07Ozs7Ozs7R0FDUCxDQUFDLENBQUM7O0FBRUgsT0FBSyxDQUFDOzs7OzsyQ0FDRSxNQUFNLENBQUMsS0FBSyxFQUFFOzs7Ozs7O0dBQ3JCLENBQUMsQ0FBQzs7QUFFSCxZQUFVLENBQUM7Ozs7QUFDVCxnQkFBTSxHQUFHLGdCQUFHLGtCQUFrQixDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQzs7Ozs7OztHQUN0RCxDQUFDLENBQUM7O0FBRUgsV0FBUyxDQUFDOzs7OzsyQ0FDRixNQUFNLENBQUMsSUFBSSxFQUFFOzs7Ozs7O0dBQ3BCLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsZ0RBQWdELEVBQUU7UUFNL0MsTUFBTTs7Ozs7MkNBTEosTUFBTSxDQUFDLElBQUksQ0FBQztBQUNoQixlQUFHLEVBQUUsWUFBWTtBQUNqQix3QkFBWSxFQUFFLEtBQUs7QUFDbkIsc0JBQVUsRUFBRSxLQUFLO1dBQ2xCLENBQUM7Ozs7MkNBQ2lCLE1BQU0sQ0FBQyxjQUFjLENBQUMsOEZBQThGLENBQUM7OztBQUFwSSxnQkFBTTs7MkNBQ0osTUFBTSxDQUFDLEtBQUssRUFBRTs7Ozs7OztHQUNyQixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9lMmUvZHJpdmVyLWUyZS1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB3ZCBmcm9tICd3ZCc7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCBjaGFpQXNQcm9taXNlZCBmcm9tICdjaGFpLWFzLXByb21pc2VkJztcbmltcG9ydCB7IHN0YXJ0U2VydmVyIH0gZnJvbSAnLi4vLi4vbGliL3NlcnZlcic7XG5jaGFpLnNob3VsZCgpO1xuY2hhaS51c2UoY2hhaUFzUHJvbWlzZWQpO1xuXG5jb25zdCBURVNUX1BPUlQgPSA0Nzg4O1xuY29uc3QgVEVTVF9IT1NUID0gXCJsb2NhbGhvc3RcIjtcblxubGV0IHNlcnZlciwgZHJpdmVyO1xuXG5kZXNjcmliZSgnRHJpdmVyJywgZnVuY3Rpb24gKCkge1xuICBiZWZvcmUoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIHNlcnZlciA9IGF3YWl0IHN0YXJ0U2VydmVyKFRFU1RfUE9SVCwgVEVTVF9IT1NUKTtcbiAgfSk7XG5cbiAgYWZ0ZXIoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IHNlcnZlci5jbG9zZSgpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBkcml2ZXIgPSB3ZC5wcm9taXNlQ2hhaW5SZW1vdGUoVEVTVF9IT1NULCBURVNUX1BPUlQpO1xuICB9KTtcblxuICBhZnRlckVhY2goYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IGRyaXZlci5xdWl0KCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcnVuIGEgYmFzaWMgc2Vzc2lvbiB1c2luZyBhIHJlYWwgY2xpZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IGRyaXZlci5pbml0KHtcbiAgICAgIGFwcDogXCJDYWxjdWxhdG9yXCIsXG4gICAgICBwbGF0Zm9ybU5hbWU6IFwiTWFjXCIsXG4gICAgICBkZXZpY2VOYW1lOiBcIk1hY1wiLFxuICAgIH0pO1xuICAgIGxldCBidXR0b24gPSBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvQVhBcHBsaWNhdGlvbltAQVhUaXRsZT0nQ2FsY3VsYXRvciddL0FYV2luZG93WzBdL0FYR3JvdXBbMV0vQVhCdXR0b25bQEFYRGVzY3JpcHRpb249J25pbmUnXVwiKTtcbiAgICBhd2FpdCBidXR0b24uY2xpY2soKTtcbiAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
