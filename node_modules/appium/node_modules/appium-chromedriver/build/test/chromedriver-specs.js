'use strict';

var _slicedToArray = require('babel-runtime/helpers/sliced-to-array')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

var _libChromedriver = require('../lib/chromedriver');

var _libChromedriver2 = _interopRequireDefault(_libChromedriver);

var _libInstall = require('../lib/install');

var install = _interopRequireWildcard(_libInstall);

var _libUtils = require('../lib/utils');

var utils = _interopRequireWildcard(_libUtils);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _appiumSupport = require('appium-support');

var _teen_process = require('teen_process');

var tp = _interopRequireWildcard(_teen_process);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

_chai2['default'].should();

describe('chromedriver', function () {
  var sandbox = undefined;
  beforeEach(function () {
    sandbox = _sinon2['default'].createSandbox();
  });
  afterEach(function () {
    sandbox.restore();
  });

  describe('getCompatibleChromedriver', function () {
    describe('desktop', function () {
      it('should find generic binary', function callee$3$0() {
        var cd, binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              sandbox.stub(install, 'getChromedriverBinaryPath').returns('/path/to/chromedriver');

              cd = new _libChromedriver2['default']({});
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 4:
              binPath = context$4$0.sent;

              binPath.should.eql('/path/to/chromedriver');

            case 6:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
    });

    describe('Android', function () {
      var cd = undefined;
      var getChromedriverBinaryPathSpy = undefined;
      before(function () {
        cd = new _libChromedriver2['default']({
          adb: {}
        });
      });
      beforeEach(function () {
        getChromedriverBinaryPathSpy = sandbox.spy(install, 'getChromedriverBinaryPath');
      });
      afterEach(function () {
        getChromedriverBinaryPathSpy.called.should.be['false'];
      });

      it('should find a compatible binary if only one binary exists', function callee$3$0() {
        var binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              sandbox.stub(utils, 'getChromeVersion').returns('63.0.3239.99');
              sandbox.stub(_appiumSupport.fs, 'glob').returns(['/path/to/chromedriver']);
              sandbox.stub(tp, 'exec').returns({
                stdout: 'ChromeDriver 2.36.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 5;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 5:
              binPath = context$4$0.sent;

              binPath.should.eql('/path/to/chromedriver');

            case 7:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should find most recent compatible binary from a number of possibilities', function callee$3$0() {
        var binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              sandbox.stub(utils, 'getChromeVersion').returns('59.0.3029.42');
              sandbox.stub(_appiumSupport.fs, 'glob').returns(['/path/to/chromedriver-36', '/path/to/chromedriver-35', '/path/to/chromedriver-34', '/path/to/chromedriver-33', '/path/to/chromedriver-32', '/path/to/chromedriver-31', '/path/to/chromedriver-30']);
              sandbox.stub(tp, 'exec').onCall(0).returns({
                stdout: 'ChromeDriver 2.36.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.35.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.34.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.33.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.32.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.31.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.30.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 5;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 5:
              binPath = context$4$0.sent;

              binPath.should.eql('/path/to/chromedriver-36');

            case 7:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should correctly determine Chromedriver versions', function callee$3$0() {
        var chromedrivers, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _step$value, _cd, expectedVersion;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              sandbox.stub(_appiumSupport.fs, 'glob').returns(['/path/to/chromedriver-36', '/path/to/chromedriver-35', '/path/to/chromedriver-34', '/path/to/chromedriver-33', '/path/to/chromedriver-32', '/path/to/chromedriver-31', '/path/to/chromedriver-30']);
              sandbox.stub(tp, 'exec').onCall(0).returns({
                stdout: 'ChromeDriver 2.36.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(1).returns({
                stdout: 'ChromeDriver 2.35.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(2).returns({
                stdout: 'ChromeDriver 2.34.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(3).returns({
                stdout: 'ChromeDriver 2.33.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(4).returns({
                stdout: 'ChromeDriver 2.32.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(5).returns({
                stdout: 'ChromeDriver 2.31.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(6).returns({
                stdout: 'ChromeDriver 2.30.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(cd.getChromedrivers({}));

            case 4:
              chromedrivers = context$4$0.sent;
              _iteratorNormalCompletion = true;
              _didIteratorError = false;
              _iteratorError = undefined;
              context$4$0.prev = 8;

              for (_iterator = _getIterator(_lodash2['default'].zip(chromedrivers, ['2.36', '2.35', '2.34', '2.33', '2.32', '2.31', '2.30'])); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                _step$value = _slicedToArray(_step.value, 2);
                _cd = _step$value[0];
                expectedVersion = _step$value[1];

                _cd.version.should.eql(expectedVersion);
              }
              context$4$0.next = 16;
              break;

            case 12:
              context$4$0.prev = 12;
              context$4$0.t0 = context$4$0['catch'](8);
              _didIteratorError = true;
              _iteratorError = context$4$0.t0;

            case 16:
              context$4$0.prev = 16;
              context$4$0.prev = 17;

              if (!_iteratorNormalCompletion && _iterator['return']) {
                _iterator['return']();
              }

            case 19:
              context$4$0.prev = 19;

              if (!_didIteratorError) {
                context$4$0.next = 22;
                break;
              }

              throw _iteratorError;

            case 22:
              return context$4$0.finish(19);

            case 23:
              return context$4$0.finish(16);

            case 24:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this, [[8, 12, 16, 24], [17,, 19, 23]]);
      });

      it('should find most recent binary from a number of possibilities when chrome is too new', function callee$3$0() {
        var binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              sandbox.stub(utils, 'getChromeVersion').returns('70.0.0.42');
              sandbox.stub(_appiumSupport.fs, 'glob').returns(['/path/to/chromedriver-9000', '/path/to/chromedriver-8999', '/path/to/chromedriver-36', '/path/to/chromedriver-35']);
              sandbox.stub(tp, 'exec').onCall(0).returns({
                stdout: 'ChromeDriver 2.9000.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.8999.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.36.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              }).onCall(0).returns({
                stdout: 'ChromeDriver 2.35.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 5;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 5:
              binPath = context$4$0.sent;

              binPath.should.eql('/path/to/chromedriver-9000');

            case 7:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should search specified directory if provided', function callee$3$0() {
        var cd, binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              cd = new _libChromedriver2['default']({
                adb: {},
                executableDir: '/some/local/dir/for/chromedrivers'
              });

              sandbox.stub(utils, 'getChromeVersion').returns('63.0.3239.99');
              sandbox.stub(_appiumSupport.fs, 'glob').withArgs('/some/local/dir/for/chromedrivers/*').returns(['/some/local/dir/for/chromedrivers/chromedriver']);
              sandbox.stub(tp, 'exec').returns({
                stdout: 'ChromeDriver 2.36.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 6:
              binPath = context$4$0.sent;

              binPath.should.eql('/some/local/dir/for/chromedrivers/chromedriver');

            case 8:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should use alternative mapping if provided', function callee$3$0() {
        var cd, binPath;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              cd = new _libChromedriver2['default']({
                adb: {},
                mappingPath: _path2['default'].resolve(__dirname, '..', '..', 'test', 'fixtures', 'alt-mapping.json')
              });

              sandbox.stub(utils, 'getChromeVersion').returns('63.0.3239.99');
              sandbox.stub(_appiumSupport.fs, 'glob').returns(['/path/to/chromedriver-42']);
              sandbox.stub(tp, 'exec').returns({
                stdout: 'ChromeDriver 2.42.540469 (1881fd7f8641508feb5166b7cae561d87723cfa8)'
              });

              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(cd.getCompatibleChromedriver());

            case 6:
              binPath = context$4$0.sent;

              binPath.should.eql('/path/to/chromedriver-42');

            case 8:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvY2hyb21lZHJpdmVyLXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OzsrQkFBeUIscUJBQXFCOzs7OzBCQUNyQixnQkFBZ0I7O0lBQTdCLE9BQU87O3dCQUNJLGNBQWM7O0lBQXpCLEtBQUs7O3FCQUNDLE9BQU87Ozs7b0JBQ1IsTUFBTTs7Ozs2QkFDSixnQkFBZ0I7OzRCQUNmLGNBQWM7O0lBQXRCLEVBQUU7O29CQUNHLE1BQU07Ozs7c0JBQ1QsUUFBUTs7OztBQUV0QixrQkFBSyxNQUFNLEVBQUUsQ0FBQzs7QUFFZCxRQUFRLENBQUMsY0FBYyxFQUFFLFlBQVk7QUFDbkMsTUFBSSxPQUFPLFlBQUEsQ0FBQztBQUNaLFlBQVUsQ0FBQyxZQUFZO0FBQ3JCLFdBQU8sR0FBRyxtQkFBTSxhQUFhLEVBQUUsQ0FBQztHQUNqQyxDQUFDLENBQUM7QUFDSCxXQUFTLENBQUMsWUFBWTtBQUNwQixXQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7R0FDbkIsQ0FBQyxDQUFDOztBQUVILFVBQVEsQ0FBQywyQkFBMkIsRUFBRSxZQUFZO0FBQ2hELFlBQVEsQ0FBQyxTQUFTLEVBQUUsWUFBWTtBQUM5QixRQUFFLENBQUMsNEJBQTRCLEVBQUU7WUFJekIsRUFBRSxFQUNGLE9BQU87Ozs7QUFKYixxQkFBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsMkJBQTJCLENBQUMsQ0FDL0MsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7O0FBRTlCLGdCQUFFLEdBQUcsaUNBQWlCLEVBQUUsQ0FBQzs7K0NBQ1QsRUFBRSxDQUFDLHlCQUF5QixFQUFFOzs7QUFBOUMscUJBQU87O0FBQ2IscUJBQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDLENBQUM7Ozs7Ozs7T0FDN0MsQ0FBQyxDQUFDO0tBQ0osQ0FBQyxDQUFDOztBQUVILFlBQVEsQ0FBQyxTQUFTLEVBQUUsWUFBWTtBQUM5QixVQUFJLEVBQUUsWUFBQSxDQUFDO0FB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Q0FBQyxDQUNyQixPQUFPLENBQUM7QUFDUCxzQkFBTSxFQUFFLHFFQUFxRTtlQUM5RSxDQUFDLENBQUM7OzsrQ0FFaUIsRUFBRSxDQUFDLHlCQUF5QixFQUFFOzs7QUFBOUMscUJBQU87O0FBQ2IscUJBQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLENBQUM7Ozs7Ozs7T0FDaEQsQ0FBQyxDQUFDO0tBQ0osQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvY2hyb21lZHJpdmVyLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENocm9tZWRyaXZlciBmcm9tICcuLi9saWIvY2hyb21lZHJpdmVyJztcbmltcG9ydCAqIGFzIGluc3RhbGwgZnJvbSAnLi4vbGliL2luc3RhbGwnO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSAnLi4vbGliL3V0aWxzJztcbmltcG9ydCBzaW5vbiBmcm9tICdzaW5vbic7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCB7IGZzIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0ICogYXMgdHAgZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuY2hhaS5zaG91bGQoKTtcblxuZGVzY3JpYmUoJ2Nocm9tZWRyaXZlcicsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IHNhbmRib3g7XG4gIGJlZm9yZUVhY2goZnVuY3Rpb24gKCkge1xuICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KCk7XG4gIH0pO1xuICBhZnRlckVhY2goZnVuY3Rpb24gKCkge1xuICAgIHNhbmRib3gucmVzdG9yZSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICBkZXNjcmliZSgnZGVza3RvcCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGl0KCdzaG91bGQgZmluZCBnZW5lcmljIGJpbmFyeScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2FuZGJveC5zdHViKGluc3RhbGwsICdnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoJylcbiAgICAgICAgICAucmV0dXJucygnL3BhdGgvdG8vY2hyb21lZHJpdmVyJyk7XG5cbiAgICAgICAgY29uc3QgY2QgPSBuZXcgQ2hyb21lZHJpdmVyKHt9KTtcbiAgICAgICAgY29uc3QgYmluUGF0aCA9IGF3YWl0IGNkLmdldENvbXBhdGlibGVDaHJvbWVkcml2ZXIoKTtcbiAgICAgICAgYmluUGF0aC5zaG91bGQuZXFsKCcvcGF0aC90by9jaHJvbWVkcml2ZXInKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0FuZHJvaWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgY2Q7XG4gICAgICBsZXQgZ2V0Q2hyb21lZHJpdmVyQmluYXJ5UGF0aFNweTtcbiAgICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNkID0gbmV3IENocm9tZWRyaXZlcih7XG4gICAgICAgICAgYWRiOiB7fSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGJlZm9yZUVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoU3B5ID0gc2FuZGJveC5zcHkoaW5zdGFsbCwgJ2dldENocm9tZWRyaXZlckJpbmFyeVBhdGgnKTtcbiAgICAgIH0pO1xuICAgICAgYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZ2V0Q2hyb21lZHJpdmVyQmluYXJ5UGF0aFNweS5jYWxsZWQuc2hvdWxkLmJlLmZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgZmluZCBhIGNvbXBhdGlibGUgYmluYXJ5IGlmIG9ubHkgb25lIGJpbmFyeSBleGlzdHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNhbmRib3guc3R1Yih1dGlscywgJ2dldENocm9tZVZlcnNpb24nKVxuICAgICAgICAgIC5yZXR1cm5zKCc2My4wLjMyMzkuOTknKTtcbiAgICAgICAgc2FuZGJveC5zdHViKGZzLCAnZ2xvYicpXG4gICAgICAgICAgLnJldHVybnMoW1xuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlcicsXG4gICAgICAgICAgXSk7XG4gICAgICAgIHNhbmRib3guc3R1Yih0cCwgJ2V4ZWMnKVxuICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgIHN0ZG91dDogJ0Nocm9tZURyaXZlciAyLjM2LjU0MDQ2OSAoMTg4MWZkN2Y4NjQxNTA4ZmViNTE2NmI3Y2FlNTYxZDg3NzIzY2ZhOCknLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGJpblBhdGggPSBhd2FpdCBjZC5nZXRDb21wYXRpYmxlQ2hyb21lZHJpdmVyKCk7XG4gICAgICAgIGJpblBhdGguc2hvdWxkLmVxbCgnL3BhdGgvdG8vY2hyb21lZHJpdmVyJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBmaW5kIG1vc3QgcmVjZW50IGNvbXBhdGlibGUgYmluYXJ5IGZyb20gYSBudW1iZXIgb2YgcG9zc2liaWxpdGllcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2FuZGJveC5zdHViKHV0aWxzLCAnZ2V0Q2hyb21lVmVyc2lvbicpXG4gICAgICAgICAgLnJldHVybnMoJzU5LjAuMzAyOS40MicpO1xuICAgICAgICBzYW5kYm94LnN0dWIoZnMsICdnbG9iJylcbiAgICAgICAgICAucmV0dXJucyhbXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTM2JyxcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItMzUnLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zNCcsXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTMzJyxcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItMzInLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zMScsXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTMwJyxcbiAgICAgICAgICBdKTtcbiAgICAgICAgc2FuZGJveC5zdHViKHRwLCAnZXhlYycpXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zNi41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zNS41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zNC41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zMy41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zMi41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zMS41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi4zMC41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGJpblBhdGggPSBhd2FpdCBjZC5nZXRDb21wYXRpYmxlQ2hyb21lZHJpdmVyKCk7XG4gICAgICAgIGJpblBhdGguc2hvdWxkLmVxbCgnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTM2Jyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgZGV0ZXJtaW5lIENocm9tZWRyaXZlciB2ZXJzaW9ucycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2FuZGJveC5zdHViKGZzLCAnZ2xvYicpXG4gICAgICAgICAgLnJldHVybnMoW1xuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zNicsXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTM1JyxcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItMzQnLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zMycsXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTMyJyxcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItMzEnLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zMCcsXG4gICAgICAgICAgXSk7XG4gICAgICAgIHNhbmRib3guc3R1Yih0cCwgJ2V4ZWMnKVxuICAgICAgICAgIC5vbkNhbGwoMClcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzYuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoMSlcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzUuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoMilcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzQuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoMylcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzMuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoNClcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzIuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoNSlcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzEuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIC5vbkNhbGwoNilcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuMzAuNTQwNDY5ICgxODgxZmQ3Zjg2NDE1MDhmZWI1MTY2YjdjYWU1NjFkODc3MjNjZmE4KScsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjaHJvbWVkcml2ZXJzID0gYXdhaXQgY2QuZ2V0Q2hyb21lZHJpdmVycyh7fSk7XG4gICAgICAgIGZvciAoY29uc3QgW2NkLCBleHBlY3RlZFZlcnNpb25dIG9mIF8uemlwKGNocm9tZWRyaXZlcnMsIFsnMi4zNicsICcyLjM1JywgJzIuMzQnLCAnMi4zMycsICcyLjMyJywgJzIuMzEnLCAnMi4zMCddKSkge1xuICAgICAgICAgIGNkLnZlcnNpb24uc2hvdWxkLmVxbChleHBlY3RlZFZlcnNpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBmaW5kIG1vc3QgcmVjZW50IGJpbmFyeSBmcm9tIGEgbnVtYmVyIG9mIHBvc3NpYmlsaXRpZXMgd2hlbiBjaHJvbWUgaXMgdG9vIG5ldycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2FuZGJveC5zdHViKHV0aWxzLCAnZ2V0Q2hyb21lVmVyc2lvbicpXG4gICAgICAgICAgLnJldHVybnMoJzcwLjAuMC40MicpO1xuICAgICAgICBzYW5kYm94LnN0dWIoZnMsICdnbG9iJylcbiAgICAgICAgICAucmV0dXJucyhbXG4gICAgICAgICAgICAnL3BhdGgvdG8vY2hyb21lZHJpdmVyLTkwMDAnLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci04OTk5JyxcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItMzYnLFxuICAgICAgICAgICAgJy9wYXRoL3RvL2Nocm9tZWRyaXZlci0zNScsXG4gICAgICAgICAgXSk7XG4gICAgICAgIHNhbmRib3guc3R1Yih0cCwgJ2V4ZWMnKVxuICAgICAgICAgIC5vbkNhbGwoMClcbiAgICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgICAgc3Rkb3V0OiAnQ2hyb21lRHJpdmVyIDIuOTAwMC41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgLm9uQ2FsbCgwKVxuICAgICAgICAgICAgLnJldHVybnMoe1xuICAgICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi44OTk5LjU0MDQ2OSAoMTg4MWZkN2Y4NjQxNTA4ZmViNTE2NmI3Y2FlNTYxZDg3NzIzY2ZhOCknLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAub25DYWxsKDApXG4gICAgICAgICAgICAucmV0dXJucyh7XG4gICAgICAgICAgICAgIHN0ZG91dDogJ0Nocm9tZURyaXZlciAyLjM2LjU0MDQ2OSAoMTg4MWZkN2Y4NjQxNTA4ZmViNTE2NmI3Y2FlNTYxZDg3NzIzY2ZhOCknLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAub25DYWxsKDApXG4gICAgICAgICAgICAucmV0dXJucyh7XG4gICAgICAgICAgICAgIHN0ZG91dDogJ0Nocm9tZURyaXZlciAyLjM1LjU0MDQ2OSAoMTg4MWZkN2Y4NjQxNTA4ZmViNTE2NmI3Y2FlNTYxZDg3NzIzY2ZhOCknLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgYmluUGF0aCA9IGF3YWl0IGNkLmdldENvbXBhdGlibGVDaHJvbWVkcml2ZXIoKTtcbiAgICAgICAgYmluUGF0aC5zaG91bGQuZXFsKCcvcGF0aC90by9jaHJvbWVkcml2ZXItOTAwMCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgc2VhcmNoIHNwZWNpZmllZCBkaXJlY3RvcnkgaWYgcHJvdmlkZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IGNkID0gbmV3IENocm9tZWRyaXZlcih7XG4gICAgICAgICAgYWRiOiB7fSxcbiAgICAgICAgICBleGVjdXRhYmxlRGlyOiAnL3NvbWUvbG9jYWwvZGlyL2Zvci9jaHJvbWVkcml2ZXJzJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2FuZGJveC5zdHViKHV0aWxzLCAnZ2V0Q2hyb21lVmVyc2lvbicpXG4gICAgICAgICAgLnJldHVybnMoJzYzLjAuMzIzOS45OScpO1xuICAgICAgICBzYW5kYm94LnN0dWIoZnMsICdnbG9iJylcbiAgICAgICAgICAud2l0aEFyZ3MoJy9zb21lL2xvY2FsL2Rpci9mb3IvY2hyb21lZHJpdmVycy8qJylcbiAgICAgICAgICAgIC5yZXR1cm5zKFtcbiAgICAgICAgICAgICAgJy9zb21lL2xvY2FsL2Rpci9mb3IvY2hyb21lZHJpdmVycy9jaHJvbWVkcml2ZXInLFxuICAgICAgICAgICAgXSk7XG4gICAgICAgIHNhbmRib3guc3R1Yih0cCwgJ2V4ZWMnKVxuICAgICAgICAgIC5yZXR1cm5zKHtcbiAgICAgICAgICAgIHN0ZG91dDogJ0Nocm9tZURyaXZlciAyLjM2LjU0MDQ2OSAoMTg4MWZkN2Y4NjQxNTA4ZmViNTE2NmI3Y2FlNTYxZDg3NzIzY2ZhOCknLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGJpblBhdGggPSBhd2FpdCBjZC5nZXRDb21wYXRpYmxlQ2hyb21lZHJpdmVyKCk7XG4gICAgICAgIGJpblBhdGguc2hvdWxkLmVxbCgnL3NvbWUvbG9jYWwvZGlyL2Zvci9jaHJvbWVkcml2ZXJzL2Nocm9tZWRyaXZlcicpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdXNlIGFsdGVybmF0aXZlIG1hcHBpbmcgaWYgcHJvdmlkZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IGNkID0gbmV3IENocm9tZWRyaXZlcih7XG4gICAgICAgICAgYWRiOiB7fSxcbiAgICAgICAgICBtYXBwaW5nUGF0aDogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJy4uJywgJ3Rlc3QnLCAnZml4dHVyZXMnLCAnYWx0LW1hcHBpbmcuanNvbicpLFxuICAgICAgICB9KTtcblxuICAgICAgICBzYW5kYm94LnN0dWIodXRpbHMsICdnZXRDaHJvbWVWZXJzaW9uJylcbiAgICAgICAgICAucmV0dXJucygnNjMuMC4zMjM5Ljk5Jyk7XG4gICAgICAgIHNhbmRib3guc3R1YihmcywgJ2dsb2InKVxuICAgICAgICAgIC5yZXR1cm5zKFtcbiAgICAgICAgICAgICcvcGF0aC90by9jaHJvbWVkcml2ZXItNDInLFxuICAgICAgICAgIF0pO1xuICAgICAgICBzYW5kYm94LnN0dWIodHAsICdleGVjJylcbiAgICAgICAgICAucmV0dXJucyh7XG4gICAgICAgICAgICBzdGRvdXQ6ICdDaHJvbWVEcml2ZXIgMi40Mi41NDA0NjkgKDE4ODFmZDdmODY0MTUwOGZlYjUxNjZiN2NhZTU2MWQ4NzcyM2NmYTgpJyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBiaW5QYXRoID0gYXdhaXQgY2QuZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlcigpO1xuICAgICAgICBiaW5QYXRoLnNob3VsZC5lcWwoJy9wYXRoL3RvL2Nocm9tZWRyaXZlci00MicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uIn0=
